---
title: Submit Aggregated Staking Data
slug: /guides/staking-api/ethereum/aggregated-staking/submit-aggregated-staking-data
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import Link from "@docusaurus/Link";

After collecting the required inputs to go with the option 1 (On-demand ETH Staking), send a `PUT` request to `/api/v1/flows/[:flow_id]/next` to proceed to the next step.

### Parameters

- `name` &mdash; `string` Name of the action to execute (required).
- `inputs` &mdash; `object` (required).
  - `funding_account_address` &mdash; `string` The wallet from which the ETH will originate (required).
  - `withdrawal_address` &mdash; `string` The withdrawal address into which you want to receive your ETH after withdrawal (required).
  - `amount` &mdash; `number` The amount of ETH you want to stake. It must be a multiple of 32. (required).

#### Sample cURL Request

```bash {5-10}
curl -X PUT 'https://eth-slate.datahub.figment.io/api/v1/flows/7d0c5354-72f0-4bac-bc29-b7384d0321a8/next' \
-H 'Content-Type: application/json' \
-H 'Authorization: <api_key>' \
-d '{
  "name": "assign_staking_data",
  "inputs": {
  "funding_account_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
  "withdrawal_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
  "amount": 32
  }
}'
```

### Response

The aggregated staking flow will provision enough validators to stake your full `amount`, even if your organization has not pre-provisioned enough validators for it. This is an async process, and may require you to await a webhook indicating provision success before proceeding. Alternatively you can poll the flow until `status aggregated_deposit_tx_signature` is reached. Therefore, there are two possible returned states:

- `awaiting_provision` &mdash; The Staking API is communicating with internal systems to provision validators for your org.
- `aggregated_deposit_tx_signature` &mdash; Your organization has enough validators available to proceed to transaction signing. This is either because there are preprovisioned validators available for your org, or the Staking API has provisioned validators for you and has advanced out of the `awaiting_provision` state.

When the flow is in `aggregated_deposit_tx_signature`, it will include an unsigned transaction payload to stake to your organization's validators. This transaction-ready state indicates three possible `actions`:

- `refresh_aggregated_deposit_tx` &mdash; If you need to get a fresh version of the transaction payload (i.e., your `funding_account`'s transaction nonce has increased).
- `sign_aggregated_deposit_tx` &mdash; Submit a signed transaction payload ready to be broadcast to the network.
- `confirm_aggregated_deposit_tx_by_hash` &mdash; Submit a previously completed transaction hash to continue the flow.

We will choose `sign_aggregated_deposit_tx`, which indicates one input to collect:

- `transaction_payload` &mdash; The signed transaction payload ready to be broadcast to the network.

#### Sample Response

<Tabs><TabItem value="awaiting_provision" label="Awaiting Validator(s) Provisioning">

```json {3-4,7-8,18-21}
{
  "id": "7d0c5354-72f0-4bac-bc29-b7384d0321a8",
  "operation": "aggregated_staking",
  "state": "awaiting_provision",
  "actions": [
    {
      "name": "wait",
      "estimated_state_change_at": "2023-04-06T06:44:08.345Z",
      "inputs": []
    }
  ],
  "data": {
    "deposits": [],
    "funding_account_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
    "withdrawal_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
    "amount": "32.0",
    "validators_to_provision": 1,
    "gas_price": null,
    "gas_limit": null,
    "estimated_active_at": null,
    "transactions": []
  },
  "network_code": "ethereum",
  "chain_code": "goerli",
  "created_at": "2023-04-06T06:37:06.055Z",
  "updated_at": "2023-04-06T06:39:07.287Z"
}
```

</TabItem><TabItem value="aggregated_deposit_tx_signature" label="Validator(s) Provisioned" default>

```json {3-4,7,11,14,22,25,70}
{
  "id": "7d0c5354-72f0-4bac-bc29-b7384d0321a8",
  "operation": "aggregated_staking",
  "state": "aggregated_deposit_tx_signature",
  "actions": [
    {
      "name": "refresh_aggregated_deposit_tx",
      "inputs": []
    },
    {
      "name": "sign_aggregated_deposit_tx",
      "inputs": [
        {
          "name": "transaction_payload",
          "display": "Transaction Payload",
          "description": "",
          "type": "signed_transaction",
          "validations": [],
          "array": false,
          "default_value": null,
          "signers": ["0xB458D87418e6020260C92e18b11b64F1ed6fFF30"],
          "transaction_payload": "0x02f902d805028459682f0085293dc82d66830116fa943e30fc2cc800af86e88b69d32d9daf7eccb3a5208901bc16d674ec800000b902a44f498c730000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000309855d353352eefb56929801e0d376cf6e5973d18c39424fe42c829cb62a6ff17648e6fdbf0c7259d25d09e17769cf27600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020010000000000000000000000b458d87418e6020260c92e18b11b64f1ed6fff3000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006094c7e3414664f4dbd1cc8d326de278ee0e4fcf4bc74fb1ea74216bab8c644ddc4fd1ed59dca7db60959f81d4dd5dd8271175113fbc0decb19486f885a5e2bc440a5b3b33184be66dd069290ebe7f47024d2799ea7b1c1eb829cc018b8334fdb00000000000000000000000000000000000000000000000000000000000000001348de8001f6b5ce424f93ca0ca090ad1986ee5969991fa02af345980e874ade6c0"
        },
        {
          "name": "signatures",
          "display": "Signatures",
          "description": "",
          "type": "array_of_signatures",
          "validations": [],
          "array": true,
          "default_value": null,
          "element_type": "signature_data",
          "signers": ["0xB458D87418e6020260C92e18b11b64F1ed6fFF30"],
          "transaction_payload": "0x02f902d805028459682f0085293dc82d66830116fa943e30fc2cc800af86e88b69d32d9daf7eccb3a5208901bc16d674ec800000b902a44f498c730000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000309855d353352eefb56929801e0d376cf6e5973d18c39424fe42c829cb62a6ff17648e6fdbf0c7259d25d09e17769cf27600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020010000000000000000000000b458d87418e6020260c92e18b11b64f1ed6fff3000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006094c7e3414664f4dbd1cc8d326de278ee0e4fcf4bc74fb1ea74216bab8c644ddc4fd1ed59dca7db60959f81d4dd5dd8271175113fbc0decb19486f885a5e2bc440a5b3b33184be66dd069290ebe7f47024d2799ea7b1c1eb829cc018b8334fdb00000000000000000000000000000000000000000000000000000000000000001348de8001f6b5ce424f93ca0ca090ad1986ee5969991fa02af345980e874ade6c0",
          "signing_payload": "0xbf2cd8a721c4845f9a13813c680ba205f166da1d5a6e0e42f92baca723feb5d0",
          "inputs": [
            {
              "name": "account_address",
              "display": "Account Address",
              "description": "",
              "type": "string",
              "validations": [
                {
                  "type": "presence",
                  "options": {}
                }
              ],
              "array": false,
              "default_value": null
            },
            {
              "name": "signature",
              "display": "Signature",
              "description": "",
              "type": "string",
              "validations": [
                {
                  "type": "presence",
                  "options": {}
                }
              ],
              "array": false,
              "default_value": null
            }
          ]
        }
      ]
    },
    {
      "name": "confirm_aggregated_deposit_tx_by_hash",
      "inputs": [
        {
          "name": "hash",
          "display": "Hash",
          "description": "",
          "type": "string",
          "validations": [
            {
              "type": "presence",
              "options": {}
            }
          ],
          "array": false,
          "default_value": null
        },
        {
          "name": "block_number",
          "display": "Block Number",
          "description": "",
          "type": "integer",
          "validations": [],
          "array": false,
          "default_value": null
        }
      ]
    }
  ],
  "data": {
    "withdrawal_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
    "validators_to_provision": 1,
    "estimated_active_at": null,
    "transactions": [
      {
        "code": "aggregated_deposit",
        "amount": "32.0",
        "raw": "0x02f902d805028459682f0085293dc82d66830116fa943e30fc2cc800af86e88b69d32d9daf7eccb3a5208901bc16d674ec800000b902a44f498c730000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000001a000000000000000000000000000000000000000000000000000000000000002600000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000309855d353352eefb56929801e0d376cf6e5973d18c39424fe42c829cb62a6ff17648e6fdbf0c7259d25d09e17769cf27600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000020010000000000000000000000b458d87418e6020260c92e18b11b64f1ed6fff3000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000006094c7e3414664f4dbd1cc8d326de278ee0e4fcf4bc74fb1ea74216bab8c644ddc4fd1ed59dca7db60959f81d4dd5dd8271175113fbc0decb19486f885a5e2bc440a5b3b33184be66dd069290ebe7f47024d2799ea7b1c1eb829cc018b8334fdb00000000000000000000000000000000000000000000000000000000000000001348de8001f6b5ce424f93ca0ca090ad1986ee5969991fa02af345980e874ade6c0",
        "signing_payload": "0xbf2cd8a721c4845f9a13813c680ba205f166da1d5a6e0e42f92baca723feb5d0",
        "signed": null,
        "hash": null,
        "status": null,
        "error": null,
        "signatures": null,
        "block_time": null,
        "inputs": {
          "funding_account_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
          "gas_price": null,
          "gas_limit": null,
          "deposits": [
            {
              "validator_pub_key": "0x9855d353352eefb56929801e0d376cf6e5973d18c39424fe42c829cb62a6ff17648e6fdbf0c7259d25d09e17769cf276",
              "withdrawal_credentials": "0x010000000000000000000000b458d87418e6020260c92e18b11b64f1ed6fff30",
              "signature": "0x94c7e3414664f4dbd1cc8d326de278ee0e4fcf4bc74fb1ea74216bab8c644ddc4fd1ed59dca7db60959f81d4dd5dd8271175113fbc0decb19486f885a5e2bc440a5b3b33184be66dd069290ebe7f47024d2799ea7b1c1eb829cc018b8334fdb0",
              "deposit_data_root": "0x348de8001f6b5ce424f93ca0ca090ad1986ee5969991fa02af345980e874ade6",
              "genesis_fork_version": "0x00001020"
            }
          ],
          "amount": "32.0"
        }
      }
    ]
  },
  "network_code": "ethereum",
  "chain_code": "goerli",
  "created_at": "2023-04-06T06:37:06.055Z",
  "updated_at": "2023-04-06T06:39:40.438Z"
}
```

</TabItem></Tabs>

:::info note

If you go with option 2 (Bring your validators) to stake ETH then you will need to pass following parameters in the request to Staking API:

- `funding_account_address` &mdash; The wallet from which the ETH will originate (required).
- `deposits` &mdash; Array of validator deposit data:
  - `validator_pub_key` &mdash; The public key of the validator to which the ETH will be deposited (required).
  - `withdrawal_credentials` &mdash; The withdrawal address for the given validator (required).
  - `signature` &mdash; A BLS proof of possession, i.e. a proof that the private key corresponding to the `validator_pub_key` is known by the signer (required).
  - `deposit_data_root` &mdash; Uniquely identifies the set of deposits made so far (required).
  - `genesis_fork_version` &mdash; The fork version of Ethereum you used as an input to create `signature` (optional).
- `gas_limit` &mdash; Adjust the gas limit (optional).
- `gas_price` &mdash; Adjust the gas price (optional).

Sample cURL Request:

```bash
curl -X PUT 'https://eth-slate.datahub.figment.io/api/v1/flows/336d0a12-4902-4b18-9219-3f0ed2ffcac7/next' \
-H 'Content-Type: application/json' \
-H 'Authorization: <api_key>' \
-d '{
  "name": "assign_staking_data",
  "inputs": {
  "funding_account_address": "0xB458D87418e6020260C92e18b11b64F1ed6fFF30",
  "deposits": [
      {
        "signature": "0xa5c28fa1507168ad64e00b4f81bb2b985f47d6129ce2d566e0103c5862acb807fd29915f106d82256c77e4dc6c6164ff12a8c76b21afe3eb693337d7885cccc38346092ded912988e26667ae17acff790fc24f8abc2d01fa05b604f9ef778064",
        "deposit_data_root": "0x67b2a367dfbb04d8f5ccf9e27619901289197f6e9aa558a7e0d855e6c13b36c8",
        "validator_pub_key": "0x8d161816dbcf2c85f053701818c688530a31ebeb1d677ccd261e2fd4aed20863885d092ec0df3698178d435d71912d33",
        "withdrawal_credentials": "0x010000000000000000000000dc780aac63683d9bd1e5be8dd8453d03f802ed85"
      }
    ]
  }
}'
```

:::

:::info note

Make sure to save the `transaction_payload` from this response, which is what needs to be signed in the next step.

:::
