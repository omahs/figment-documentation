import img1 from "@site/static/img/staking/workflows/v1/avalanche/Workflows::V1::Avalanche::StakingFlow_workflow.png";
import { APIReferenceNav } from "@site/src/components/APIReferenceNav";

## Staking

Delegating AVAX is a simple process. We will collect:

- The delegating address
- The signing public key
- The validator address
- The amount of AVAX to be staked
- Optionally, a max gas amount (upper limit of the transaction fee to be paid)

Once the delegating transaction is confirmed on-chain, the delegation will immediately be active and earning staking rewards.

:::info note

Please note that there is no concept of unstaking or undelegating on Avalanche.  
Delegations are active until the end time specified at delegation creation, and automatically deactivate and become liquid at that specified time.
If no end time is specified, it will default to the end time of the validator.

This can not be changed once the delegation transaction is confirmed on-chain.

:::

### Flow Diagram

<img
  src={img1}
  alt="Avalanche Delegation Flow Diagram"
  className="inline-image"
/>

### Actions

<APIReferenceNav
  service="staking-api"
  network="avalanche"
  folders={undefined}
  path="docs/staking/02_networks/avalanche/index.mdx"
  methods={[
    {
      name: "Create New Staking Flow",
    },
    {
      name: "Submit Delegate Transaction Data",
    },
    {
      name: "Submit Signed Delegate Transaction for Broadcast",
    },
    {
      name: "Get Staking Flow Status",
    },
  ]}
/>

<!---

### Process

1. To initiate the AVAX delegation process, create a new flow with a `POST` request to the `/api/v1/flows` endpoint.
2. The response indicates one possible action: `create_delegate_tx`. Use this action to generate a delegation transaction to stake your AVAX.
3. The `create_delegate_tx` action indicates five fields for data collection:
   - `delegator_address` — The delegating address, where AVAX is being staked from. This must be a P-chain address.
   - `validator_address` — Figment's validator address.
   - `amount` — The amount of AVAX to be delegated.
   - `start_time` — Optional timestamp for when the delegation will be active.
   - `end_time` — Optional timestamp for when the delegation will end.
   - `memo` — A plaintext memo to identify the transaction.
4. After collecting the required inputs, send a `PUT` request to `/api/v1/flows/[:flow_id]/next` to proceed to the next step. `[:flow_id]` must be the Flow ID you received in the response when the flow was created.
5. Sign the transaction using the `transaction_payload` you received in response to submitting the delegation data.
   - Locate the `transaction_payload` in the response from the previous step. It will look something like this:

```text
"transaction_payload": "84a40081825820e382ce19b8e07a2ba498c0afc6290dcf96bfd156f5aab2710278b3ead082a89900018182583900601472a7a59c965d819da3b0b0c33b04cbcd8e7cb10c5b137687d4dbe3bc1d4228d3b40b729a96d7fce249aee6c0842e6c1ce2d2496b51c71a05d22f0a021a0002a1fd048183028200581ce3bc1d4228d3b40b729a96d7fce249aee6c0842e6c1ce2d2496b51c7581c74f5dd2551c2c0fd71aebb95e1f58d0b742c0fd2ff1712644f709bdca1008282582030ec1947d160c6df333acb40b45df140cdaa4cecb7a80f6e3e5c7bef7b80d51958403389e4ba4a2c87efa2c457f9f74fdc04defae77c95888d1049d94e329ff72aad0ca7df3bfbb4dc5131a430ad987f3358a2605b6ba3abda7e08787e65e901df01825820fd3d08c3218598a7bcbed603c94b56c8685e5f6ce37cf5070eb009bd8bc6c1c5584099bf8a62571ad63f00df0bd70fa78969f052a4462cc65062fde3c9a2777cc316635604310de0d372206bd14b5aadf4b4c37e60028875243f253e9062538bbb01f5f6"
```

:::caution important

Always confirm the details of the transaction before signing the payload.

Figment has a tool for signing and decoding Staking API payloads, see the guide [Signing Transactions with Figment's npm Package](/staking/guides/figment-signing-transactions) to continue.

For custodial signing with the Fireblocks API, please refer to the guide [Signing Transactions with the Fireblocks API](/staking/guides/fireblocks-signing-transactions).

:::

6. After signing the transaction, send a `PUT` request to `/api/v1/flows/[:flow_id]/next` with the signed payload. The Staking API will broadcast the transaction to the Avalanche network.

### Flow States

Once a flow is created, you can get the current state of the flow by sending a `GET` request to `/api/v1/flows/[:flow_id]`.

You can also get the current state of all flows that have been created by your account with a `GET` request to `/api/v1/flows`, without specifying a Flow ID.

### Webhooks

If you require webhook notifications for Staking API events, refer to the [Webhooks API Reference](/staking/avalanche/#webhooks-api-reference) as well as the [Webhooks guide](/staking/guides/webhooks).

--->
